<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#212830">
  <title>TIMETOACT GROUP - ERP Transformation Advisory</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23212830' width='100' height='100' rx='15'/><text x='50' y='68' font-size='45' text-anchor='middle' fill='%23DA5500' font-family='sans-serif' font-weight='bold'>TTA</text></svg>">
  <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
  <style>
    :root {
      /* TIMETOACT Corporate Design */
      --tta-dark: #212830;
      --tta-darker: #1a2028;
      --tta-white: #FFFFFF;
      --tta-gray-light: #F5F5F5;
      --tta-gray-medium: #E0E0E0;
      --tta-gray-text: #9CA3AF;
      --tta-blue-light: #7CC2FA;
      --tta-orange: #DA5500;
      --tta-orange-hover: #C44D00;
      --tta-teal: #098F9B;
      --tta-blue: #205EA7;
      --tta-teal-dark: #006B76;
      --tta-blue-dark: #064A80;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Arial, sans-serif;
      background: var(--tta-dark);
      color: var(--tta-white);
      min-height: 100vh;
      line-height: 1.6;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .fade-in { animation: fadeIn 0.3s ease-out; }

    h1, h2, h3, h4 { font-family: 'Segoe UI Semibold', 'Segoe UI', Arial, sans-serif; font-weight: 600; }

    .container { max-width: 950px; margin: 0 auto; padding: 16px; }

    /* Header */
    .header { padding: 30px 20px 20px; text-align: center; }
    .logo-text { font-size: 11px; letter-spacing: 3px; color: var(--tta-white); opacity: 0.7; margin-bottom: 4px; }
    .logo-main { font-size: 28px; font-weight: 700; letter-spacing: 1px; color: var(--tta-white); }
    .logo-main span { color: var(--tta-orange); }
    .tagline { margin-top: 16px; font-size: 14px; color: var(--tta-white); opacity: 0.9; }
    .tagline-highlight { display: inline-block; margin-top: 8px; }
    .tagline-highlight span { font-weight: 600; margin: 0 4px; color: var(--tta-orange); }

    /* Stats Banner */
    .stats-banner {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin: 20px auto;
      max-width: 600px;
    }
    .stat-box {
      background: var(--tta-darker);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 12px 8px;
      text-align: center;
    }
    .stat-number { font-size: 24px; font-weight: 700; color: var(--tta-orange); }
    .stat-label { font-size: 10px; color: var(--tta-white); opacity: 0.8; margin-top: 4px; }

    /* Main Card */
    .main-card {
      background: var(--tta-white);
      border-radius: 16px;
      padding: 24px;
      margin: 20px auto;
      max-width: 800px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    }
    .card-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--tta-dark);
      text-align: center;
      margin-bottom: 8px;
    }
    .card-subtitle {
      font-size: 12px;
      color: #666;
      text-align: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--tta-gray-light);
    }
    .section-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--tta-dark);
      margin: 20px 0 12px;
      padding-top: 16px;
      border-top: 2px solid var(--tta-gray-light);
    }

    /* Phase Grid */
    .phase-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
    @media (max-width: 600px) { .phase-grid { grid-template-columns: repeat(2, 1fr); } }

    .phase-button {
      background: var(--tta-dark);
      border: none;
      border-radius: 10px;
      padding: 14px 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      position: relative;
    }
    .phase-button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(10, 26, 41, 0.4); }
    .phase-button:active { transform: scale(0.98); }
    .phase-button.analyse { border-bottom: 3px solid var(--tta-teal); }
    .phase-button.konzeption { border-bottom: 3px solid var(--tta-blue); }
    .phase-button.umsetzung { border-bottom: 3px solid var(--tta-orange); }
    .phase-button.betrieb { border-bottom: 3px solid var(--tta-teal-dark); }
    .phase-number { font-size: 20px; font-weight: 700; color: var(--tta-orange); }
    .phase-title { font-size: 11px; font-weight: 600; color: var(--tta-white); margin: 4px 0; }
    .phase-count { font-size: 9px; color: var(--tta-blue-light); }

    /* Info Buttons */
    .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 12px; }
    @media (max-width: 500px) { .info-grid { grid-template-columns: 1fr; } }

    .info-button {
      background: var(--tta-gray-light);
      border: 1px solid var(--tta-gray-medium);
      border-radius: 8px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: left;
    }
    .info-button:hover { background: var(--tta-gray-medium); transform: translateY(-2px); }
    .info-button-title { font-size: 11px; font-weight: 600; color: var(--tta-dark); }
    .info-button-desc { font-size: 9px; color: #666; margin-top: 4px; }

    /* Topic Grid */
    .topic-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
    @media (min-width: 500px) { .topic-grid { grid-template-columns: repeat(3, 1fr); } }

    .topic-button {
      background: rgba(124, 194, 250, 0.1);
      border: 1px solid rgba(124, 194, 250, 0.3);
      border-left: 3px solid var(--tta-teal);
      border-radius: 8px;
      padding: 12px 10px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: left;
      font-size: 11px;
      font-weight: 500;
      color: var(--tta-white);
    }
    .topic-button:hover { background: rgba(124, 194, 250, 0.2); border-color: var(--tta-blue-light); transform: translateX(3px); }
    .topic-button:active { transform: scale(0.98); }
    .topic-button.analyse { border-left-color: var(--tta-teal); }
    .topic-button.konzeption { border-left-color: var(--tta-blue); }
    .topic-button.umsetzung { border-left-color: var(--tta-orange); }
    .topic-button.betrieb { border-left-color: var(--tta-teal-dark); }

    /* Selection Mode */
    .selection-bar {
      background: linear-gradient(135deg, var(--tta-orange) 0%, #B34700 100%);
      padding: 12px 20px;
      border-radius: 10px;
      margin-bottom: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    .selection-info {
      font-size: 13px;
      font-weight: 600;
      color: var(--tta-white);
    }
    .selection-count {
      background: var(--tta-white);
      color: var(--tta-orange);
      padding: 2px 10px;
      border-radius: 12px;
      font-weight: 700;
      margin-left: 8px;
    }
    .selection-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .download-button, .clear-button, .toggle-select-button {
      background: var(--tta-white);
      color: var(--tta-dark);
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .download-button:hover { background: var(--tta-gray-light); transform: translateY(-1px); }
    .clear-button { background: transparent; color: var(--tta-white); border: 1px solid var(--tta-white); }
    .clear-button:hover { background: rgba(255,255,255,0.1); }
    .toggle-select-button { background: var(--tta-teal); color: var(--tta-white); }
    .toggle-select-button:hover { background: var(--tta-teal-dark); }
    .toggle-select-button.active { background: var(--tta-orange); }

    /* Topic Item with Checkbox */
    .topic-item {
      display: flex;
      align-items: stretch;
      gap: 0;
    }
    .topic-checkbox-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(218, 85, 0, 0.2);
      border: 1px solid var(--tta-orange);
      border-right: none;
      border-radius: 8px 0 0 8px;
      padding: 0 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .topic-checkbox-wrapper:hover { background: rgba(218, 85, 0, 0.3); }
    .topic-checkbox-wrapper.checked { background: var(--tta-orange); }
    .topic-checkbox {
      width: 18px;
      height: 18px;
      accent-color: var(--tta-orange);
      cursor: pointer;
    }
    .topic-item .topic-button {
      border-radius: 0 8px 8px 0;
      flex: 1;
    }
    .topic-item .topic-button.selected {
      background: rgba(218, 85, 0, 0.2);
      border-color: var(--tta-orange);
    }

    /* Complexity Selector */
    .complexity-selector {
      display: flex;
      gap: 4px;
      background: rgba(10, 26, 41, 0.8);
      padding: 4px;
      border-radius: 6px;
      margin-left: 8px;
    }
    .complexity-btn {
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      font-size: 9px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      background: transparent;
      color: var(--tta-white);
      opacity: 0.6;
    }
    .complexity-btn:hover { opacity: 1; }
    .complexity-btn.active { opacity: 1; }
    .complexity-btn.low.active { background: #28a745; color: white; }
    .complexity-btn.medium.active { background: #ffc107; color: #333; }
    .complexity-btn.high.active { background: #dc3545; color: white; }

    /* Calculation Display */
    .calculation-panel {
      background: linear-gradient(135deg, rgba(9, 143, 155, 0.15) 0%, rgba(32, 94, 167, 0.15) 100%);
      border: 1px solid var(--tta-teal);
      border-radius: 12px;
      padding: 20px;
      margin: 16px 0;
    }
    .calculation-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--tta-teal);
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .calculation-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
    }
    .calc-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }
    .calc-label {
      font-size: 10px;
      color: var(--tta-white);
      opacity: 0.7;
      margin-bottom: 4px;
    }
    .calc-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--tta-orange);
    }
    .calc-unit {
      font-size: 10px;
      color: var(--tta-white);
      opacity: 0.7;
    }
    .calc-breakdown {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    .calc-breakdown-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--tta-white);
      margin-bottom: 8px;
    }
    .calc-breakdown-item {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      padding: 4px 0;
      color: var(--tta-white);
      opacity: 0.8;
    }
    .complexity-badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 8px;
      font-weight: 600;
      margin-left: 6px;
    }
    .complexity-badge.low { background: #28a745; color: white; }
    .complexity-badge.medium { background: #ffc107; color: #333; }
    .complexity-badge.high { background: #dc3545; color: white; }

    /* Selected Topic Row */
    .selected-topic-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(255,255,255,0.05);
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 6px;
    }
    .selected-topic-name {
      font-size: 11px;
      color: var(--tta-white);
      flex: 1;
    }

    /* Page Content */
    .page-content { background: var(--tta-dark); min-height: 100vh; padding: 20px; }
    .page-container { max-width: 900px; margin: 0 auto; }
    .page-header {
      background: linear-gradient(135deg, var(--tta-teal) 0%, var(--tta-teal-dark) 100%);
      color: var(--tta-white);
      padding: 20px 24px;
      border-radius: 12px;
      margin-bottom: 16px;
    }
    .page-header.analyse { background: linear-gradient(135deg, var(--tta-teal) 0%, var(--tta-teal-dark) 100%); }
    .page-header.konzeption { background: linear-gradient(135deg, var(--tta-blue) 0%, var(--tta-blue-dark) 100%); }
    .page-header.umsetzung { background: linear-gradient(135deg, var(--tta-orange) 0%, #B34700 100%); }
    .page-header.betrieb { background: linear-gradient(135deg, var(--tta-teal-dark) 0%, #004D54 100%); }
    .page-header h1 { font-size: 20px; font-weight: 600; }
    .page-header-sub { font-size: 12px; opacity: 0.9; margin-top: 4px; }

    /* Back Button */
    .back-button {
      background: var(--tta-orange);
      color: var(--tta-white);
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 16px;
    }
    .back-button:hover { background: #C44D00; transform: translateY(-1px); }
    .back-button:active { transform: scale(0.98); }

    /* Detail View */
    .detail-card {
      background: var(--tta-white);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 16px;
    }
    .detail-header {
      font-size: 20px;
      font-weight: 600;
      color: var(--tta-dark);
      padding-bottom: 12px;
      margin-bottom: 16px;
      border-bottom: 3px solid var(--tta-teal);
    }
    .detail-section {
      margin-bottom: 20px;
    }
    .detail-label {
      font-size: 11px;
      color: var(--tta-teal);
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .detail-text {
      font-size: 14px;
      line-height: 1.7;
      color: var(--tta-dark);
    }
    .detail-list {
      list-style: none;
      padding: 0;
    }
    .detail-list li {
      padding: 6px 0 6px 20px;
      position: relative;
      font-size: 13px;
      color: var(--tta-dark);
    }
    .detail-list li:before {
      content: "✓";
      position: absolute;
      left: 0;
      color: var(--tta-teal);
      font-weight: bold;
    }
    .deliverable-box {
      background: var(--tta-gray-light);
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
    }
    .deliverable-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--tta-orange);
      margin-bottom: 8px;
      text-transform: uppercase;
    }
    .highlight-box {
      background: linear-gradient(135deg, rgba(218, 85, 0, 0.1) 0%, rgba(9, 143, 155, 0.1) 100%);
      border-left: 3px solid var(--tta-orange);
      padding: 12px 16px;
      margin: 12px 0;
      border-radius: 0 8px 8px 0;
    }
    .highlight-box p {
      font-size: 13px;
      color: var(--tta-dark);
      font-style: italic;
    }

    /* Breadcrumb */
    .breadcrumb {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 12px;
      font-size: 11px;
      color: rgba(255,255,255,0.6);
    }
    .breadcrumb-link { color: var(--tta-blue-light); cursor: pointer; text-decoration: underline; }
    .breadcrumb-link:hover { color: var(--tta-white); }

    /* Footer */
    .footer {
      text-align: center;
      padding: 30px 20px;
      color: rgba(255,255,255,0.5);
      font-size: 11px;
    }
    .footer-tagline { color: var(--tta-white); font-size: 12px; margin-bottom: 8px; }
    .footer-tagline span { color: var(--tta-orange); font-weight: 600; }

    /* Christmas Banner */
    .christmas-banner {
      background: linear-gradient(90deg, var(--tta-teal-dark) 0%, var(--tta-teal) 50%, var(--tta-teal-dark) 100%);
      color: var(--tta-white);
      text-align: center;
      padding: 10px;
      font-size: 12px;
      font-weight: 600;
    }

    /* Advantage Cards */
    .advantage-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 16px 0; }
    @media (max-width: 500px) { .advantage-grid { grid-template-columns: 1fr; } }
    .advantage-card {
      background: var(--tta-gray-light);
      border-radius: 10px;
      padding: 16px;
      border-left: 3px solid var(--tta-orange);
    }
    .advantage-card h4 { font-size: 13px; color: var(--tta-dark); margin-bottom: 8px; }
    .advantage-card p { font-size: 11px; color: #666; }

    /* Hero Value Proposition Section */
    .hero-values {
      max-width: 900px;
      margin: 0 auto 30px;
      padding: 0 16px;
    }
    .hero-values-card {
      background: var(--tta-darker);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 32px;
    }
    .hero-values-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--tta-white);
      text-align: center;
      margin-bottom: 8px;
    }
    .hero-values-subtitle {
      font-size: 13px;
      color: var(--tta-gray-text);
      text-align: center;
      margin-bottom: 28px;
    }
    .values-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
    }
    @media (max-width: 700px) { .values-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 450px) { .values-grid { grid-template-columns: 1fr; } }
    .value-item {
      background: var(--tta-dark);
      border-radius: 12px;
      padding: 20px 16px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.08);
      transition: all 0.3s ease;
    }
    .value-item:hover {
      border-color: var(--tta-orange);
      transform: translateY(-2px);
    }
    .value-icon {
      font-size: 28px;
      margin-bottom: 12px;
    }
    .value-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--tta-orange);
      margin-bottom: 6px;
    }
    .value-desc {
      font-size: 11px;
      color: var(--tta-gray-text);
      line-height: 1.5;
    }
    .hero-quote {
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px solid rgba(255,255,255,0.1);
      text-align: center;
    }
    .hero-quote p {
      font-size: 15px;
      font-style: italic;
      color: var(--tta-white);
      opacity: 0.9;
    }

    /* Success Stories Section */
    .success-section {
      max-width: 900px;
      margin: 30px auto;
      padding: 0 16px;
    }
    .success-section-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--tta-white);
      text-align: center;
      margin-bottom: 20px;
    }
    .success-section-title span {
      color: var(--tta-orange);
    }
    .success-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    @media (max-width: 700px) { .success-grid { grid-template-columns: 1fr; } }
    .success-card {
      background: var(--tta-white);
      border-radius: 12px;
      padding: 24px;
      position: relative;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    .success-card.featured {
      border-top: 3px solid var(--tta-orange);
    }
    .success-badge {
      position: absolute;
      top: -10px;
      right: 16px;
      background: var(--tta-orange);
      color: white;
      font-size: 9px;
      font-weight: 700;
      padding: 4px 10px;
      border-radius: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .success-logo {
      font-size: 11px;
      font-weight: 600;
      color: var(--tta-dark);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      opacity: 0.6;
    }
    .success-quote {
      font-size: 13px;
      color: var(--tta-dark);
      line-height: 1.7;
      font-style: italic;
      margin-bottom: 16px;
      min-height: 80px;
    }
    .success-author {
      border-top: 1px solid var(--tta-gray-medium);
      padding-top: 12px;
    }
    .success-author-name {
      font-size: 12px;
      font-weight: 700;
      color: var(--tta-dark);
    }
    .success-author-role {
      font-size: 10px;
      color: #666;
      line-height: 1.4;
    }
    .success-results {
      display: flex;
      gap: 12px;
      margin-top: 12px;
    }
    .success-result {
      background: var(--tta-gray-light);
      border-radius: 8px;
      padding: 8px 12px;
      text-align: center;
      flex: 1;
    }
    .success-result-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--tta-orange);
    }
    .success-result-label {
      font-size: 9px;
      color: #666;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    // =====================================================
    // TIMETOACT GROUP - ERP Transformation Advisory
    // Wir mappen Ihre Prozesse zum passenden ERP
    // =====================================================

    // =====================================================
    // EXPERTENQUELLEN FÜR GLAUBWÜRDIGKEIT
    // =====================================================
    const expertQuotes = {
      gartner: {
        failure: "Bis 2027 werden mehr als 70% der kürzlich implementierten ERP-Initiativen ihre ursprünglichen Business-Case-Ziele nicht vollständig erreichen. Bis zu 25% davon werden katastrophal scheitern.",
        adoption: "Geringe Endanwender-Akzeptanz entsteht, wenn Anwender die Gründe für die ERP-Implementierung und deren Auswirkungen auf sie nicht verstehen.",
        source: "Gartner Research, 2024"
      },
      mckinsey: {
        transformation: "Weniger als ein Drittel der organisatorischen Transformationen sind erfolgreich. Bei digitalen Transformationen liegt die Erfolgsquote sogar noch niedriger – nur 16% verbessern die Performance nachhaltig.",
        changeStory: "Unternehmen, deren Management eine klare Change-Story etabliert, haben eine 3,1-mal höhere Erfolgsrate.",
        tools: "Die Implementierung digitaler Tools, um Informationen unternehmensweit zugänglich zu machen, kann die Erfolgsrate von Transformationen mehr als verdoppeln.",
        source: "McKinsey Global Survey on Digital Transformations"
      },
      prosci: {
        changeManagement: "Projekte mit exzellentem Change Management sind 7-mal wahrscheinlicher erfolgreich als solche mit schlechtem Change Management.",
        sponsor: "Projekte mit gutem oder exzellentem Executive-Sponsor-Zugang haben eine Erfolgsquote von 72%.",
        adoption: "Mit effektivem Change Management sehen Unternehmen operative Verbesserungen und finanzielle Erträge Monate früher als bei Implementierungen, die die menschliche Seite des Wandels vernachlässigen.",
        erpSuccess: "Nur 55% der ERP-Projekte erreichen oder übertreffen ihre Ziele.",
        source: "Prosci Best Practices Research"
      },
      industry: {
        budget: "55-75% aller ERP-Projekte erreichen ihre Ziele nicht. Die häufigsten Probleme: Budgetüberschreitung (55%), Terminüberschreitung (47%) und mangelnde Transparenz (53%).",
        dataQuality: "Datenqualitätsprobleme sind eine der Hauptursachen für ERP-Projektverzögerungen. Unternehmen identifizieren sowohl Genauigkeits- als auch Datentransformationsprobleme bei der Migration.",
        complexity: "Prozesskomplexität ist die größte Herausforderung (62%), gefolgt von Integration (49%) und dem Verständnis von Prozessanforderungen (49%).",
        source: "Branchenstudien 2024/2025"
      }
    };

    const detailContent = {
      // === WARUM ADVISORY ===
      "warum-advisory": {
        title: "Warum ERP Transformation Advisory?",
        phase: "info",
        content: {
          intro: `Laut Gartner werden bis 2027 mehr als 70% der ERP-Initiativen ihre Business-Case-Ziele nicht erreichen – bis zu 25% scheitern katastrophal. 55-75% aller ERP-Projekte verfehlen ihre Ziele. Die Hauptursachen sind bekannt – und vermeidbar.`,
          sections: [
            {
              label: "Die vier Hauptursachen für ERP-Projektprobleme",
              items: [
                "Unklare Prozessanforderungen: Fehlende Ist-Analyse führt zu Scope Creep und nachträglichen Änderungen",
                "Schlechte Datenqualität: Datenprobleme sind eine der Hauptursachen für Go-Live-Verzögerungen",
                "Unrealistische Planung: 47% der Projekte überschreiten die Timeline (Branchenstudien)",
                "Fehlende unabhängige QA: Der Systemintegrator kontrolliert sich selbst – mit vorhersehbaren Ergebnissen"
              ]
            },
            {
              label: "Was die Forschung zeigt",
              text: "McKinsey: Nur 16% der digitalen Transformationen verbessern die Performance nachhaltig. Prosci: Projekte mit exzellentem Change Management sind 7-mal wahrscheinlicher erfolgreich."
            }
          ],
          highlight: "Die Lösung: Ein unabhängiger Advisory-Partner, der Ihre Interessen vertritt – nicht die des ERP-Vendors oder Systemintegrators.",
          deliverables: ["Objektive Bewertung", "Risikominimierung", "Budgetsicherheit", "Projekterfolg"]
        }
      },
      "interessenkonflikte": {
        title: "Interessenkonflikte der Systemintegratoren",
        phase: "info",
        content: {
          intro: `Große Systemintegratoren haben strukturelle Interessenkonflikte, die unabhängig von den handelnden Personen bestehen. Diese Konflikte können Ihrem Projekt schaden.`,
          sections: [
            {
              label: "Lizenzprovisionen – Vendor-Abhängigkeit",
              text: "Große SIs verdienen an ERP-Lizenzen. Die Empfehlung fällt oft zugunsten des Partners aus – nicht zugunsten Ihrer Prozesse. Sie erhalten möglicherweise nicht das ERP, das am besten zu Ihnen passt."
            },
            {
              label: "Junior-Pyramide – Unerfahrene Teams",
              text: "Senior-Partner verkaufen, Juniors liefern. Sie zahlen für die Einarbeitung unerfahrener Berater auf Ihre Kosten statt für echte Erfahrung und produktive Arbeit ab Tag 1."
            },
            {
              label: "Scope-Maximierung – Mehr ist mehr",
              text: "Je größer das Projekt, desto höher der Umsatz. Es fehlt der Anreiz, schlanke und effiziente Lösungen zu empfehlen. Customizations werden gefördert statt verhindert."
            }
          ],
          highlight: "Das Geschäftsmodell erzeugt systemische Interessenkonflikte – unabhängig von den handelnden Personen.",
          deliverables: ["Objektive Beratung", "Keine Lizenzprovisionen", "Senior-Berater", "Fokus auf Ihre Ziele"]
        }
      },
      "vorteile": {
        title: "Unsere vier unfairen Vorteile",
        phase: "info",
        content: {
          intro: `Wir haben unser Geschäftsmodell bewusst so gestaltet, dass unsere Interessen mit Ihren übereinstimmen. Das macht uns zum idealen Partner für Ihre ERP-Transformation.`,
          sections: [
            {
              label: "100% Herstellerneutral",
              text: "Keine Lizenzen, keine Provisionen. Wir empfehlen das ERP, das zu Ihren Prozessen passt – ob SAP, Oracle, Microsoft, Infor oder andere. Unsere Empfehlung basiert auf Ihren Anforderungen, nicht auf unserer Marge."
            },
            {
              label: "Process First",
              text: "Wir verstehen und optimieren Ihre Prozesse zuerst – dann wählen wir die Technologie. Das verhindert teure Customizations und stellt sicher, dass das ERP zu Ihnen passt, nicht umgekehrt."
            },
            {
              label: "Senior-Only",
              text: "Keine Junior-Pyramide. Erfahrene Berater mit Cross-ERP-Erfahrung, produktiv ab Tag 1. Sie bezahlen für Ergebnisse, nicht für Einarbeitung."
            },
            {
              label: "Modularer Baukasten",
              text: "21 Services in 4 Phasen. Einzeln buchbar, kein Vendor Lock-in. Flexibel rein, flexibel raus – Sie entscheiden über den Umfang."
            }
          ],
          highlight: "Wir verkaufen keine Lizenzen. Wir liefern Projekterfolg.",
          deliverables: ["Objektive Empfehlungen", "Multi-ERP Know-how", "Keine teuren Customizations", "Flexibel rein, flexibel raus"]
        }
      },
      "erp-systeme": {
        title: "Erst Prozesse, dann Technologie",
        phase: "info",
        content: {
          intro: `Der übliche Weg: ERP zuerst wählen, dann Prozesse anpassen. Das führt zu teuren Customizations und Vendor Lock-in. Unser Weg: Prozesse verstehen, optimieren, dann objektiv das beste ERP wählen.`,
          sections: [
            {
              label: "Der übliche Weg (problematisch)",
              items: [
                "Vendor empfiehlt ERP basierend auf Partnerschaft",
                "Prozesse werden an das System angepasst",
                "Teure Customizations entstehen",
                "Vendor Lock-in wird zementiert"
              ]
            },
            {
              label: "Unser Weg (empfohlen)",
              items: [
                "Ist-Prozesse verstehen und dokumentieren",
                "Soll-Prozesse definieren und optimieren",
                "ERP-Systeme objektiv vergleichen",
                "Beste Lösung für IHRE Anforderungen wählen"
              ]
            },
            {
              label: "Unterstützte ERP-Systeme",
              text: "SAP S/4HANA, Oracle Cloud, Microsoft Dynamics 365, Infor, IFS, Odoo und weitere. Wir kennen die Stärken und Schwächen jedes Systems und empfehlen objektiv."
            }
          ],
          highlight: "Wir mappen Ihre Geschäftsprozesse zum passenden ERP – nicht umgekehrt.",
          deliverables: ["Prozess-Dokumentation", "ERP-Vergleich", "Objektive Empfehlung", "Fit-to-Standard"]
        }
      },

      // === PHASE 1: ANALYSE ===
      "process-mapping": {
        title: "Process Mapping",
        phase: "analyse",
        content: {
          intro: `Das Process Mapping ist der Grundstein jeder erfolgreichen ERP-Transformation. Wir dokumentieren Ihre Ist-Prozesse und identifizieren Optimierungspotenziale – bevor Sie sich für ein ERP entscheiden. Branchenstudien zeigen: Prozesskomplexität ist mit 62% die größte Herausforderung bei ERP-Migrationen.`,
          sections: [
            {
              label: "Was wir tun",
              items: [
                "Strukturierte Prozessaufnahme in Workshops mit Ihren Fachbereichen",
                "Dokumentation in BPMN 2.0 für einheitliches Verständnis",
                "Identifikation von Medienbrüchen und Ineffizienzen",
                "Benchmarking gegen Best Practices Ihrer Branche",
                "Priorisierung der Optimierungspotenziale nach Business Impact"
              ]
            },
            {
              label: "Warum das wichtig ist",
              text: "Das Verstehen und Definieren von Prozessanforderungen ist mit 49% eine der Top-3-Herausforderungen bei ERP-Projekten. Ohne klare Prozessdokumentation wird jedes ERP-Projekt zum Blindflug. Scope Creep und Budgetüberschreitungen sind die Folge."
            }
          ],
          highlight: "Wer seine Prozesse nicht kennt, kann kein ERP auswählen. Wer seine Prozesse kennt, wählt das richtige ERP.",
          deliverables: ["Prozesslandkarte (BPMN)", "Optimierungspotenziale", "Pain Points dokumentiert", "Prozess-KPIs"]
        }
      },
      "readiness-assessment": {
        title: "Readiness Assessment",
        phase: "analyse",
        content: {
          intro: `Das Readiness Assessment bewertet, wie bereit Ihre Organisation für eine ERP-Transformation wirklich ist. Gartner warnt: Bis zu 25% der ERP-Initiativen scheitern katastrophal – oft weil Gaps und Risiken zu spät erkannt werden.`,
          sections: [
            {
              label: "Assessment-Dimensionen",
              items: [
                "Organisatorische Readiness: Change-Fähigkeit, Ressourcenverfügbarkeit, Management-Commitment",
                "Technische Readiness: IT-Infrastruktur, Systemlandschaft, Integrationsfähigkeit",
                "Prozess-Readiness: Standardisierungsgrad, Dokumentationsstand, Prozessreife",
                "Daten-Readiness: Datenqualität, Stammdaten-Governance, Migrationsfähigkeit",
                "Budget- und Zeitrahmen-Realismus: 47% der ERP-Projekte überschreiten die Zeitplanung"
              ]
            },
            {
              label: "Ergebnis",
              text: "Sie erhalten einen detaillierten Readiness-Report mit Ampelbewertung für jede Dimension, identifizierten Gaps und konkreten Handlungsempfehlungen zur Schließung der Gaps vor Projektstart."
            }
          ],
          highlight: "Ein ehrliches Readiness Assessment heute verhindert teure Überraschungen morgen.",
          deliverables: ["Readiness-Report", "Gap-Analyse", "Handlungsempfehlungen", "Risiko-Assessment"]
        }
      },
      "business-case": {
        title: "Business Case & ROI",
        phase: "analyse",
        content: {
          intro: `Ein fundierter Business Case ist die Grundlage für die Projektfreigabe und das Budget. 55% der ERP-Projekte überschreiten das Budget – oft weil der Business Case unrealistisch war. Wir erstellen eine realistische TCO-Berechnung und ROI-Analyse.`,
          sections: [
            {
              label: "Business-Case-Inhalte",
              items: [
                "Ist-Kosten-Analyse: Was kostet Ihre aktuelle Systemlandschaft wirklich?",
                "Investitionskosten: Lizenzen, Implementierung, Hardware, Schulung",
                "Laufende Kosten: Wartung, Support, Betrieb, Updates",
                "Quantifizierbare Benefits: Prozesseffizienz, Automatisierung, Zeitersparnis",
                "Qualitative Benefits: Transparenz, Entscheidungsqualität, Compliance"
              ]
            },
            {
              label: "TCO-Vergleich",
              text: "Wir vergleichen die Total Cost of Ownership verschiedener ERP-Optionen über 5-10 Jahre. So sehen Sie, welche Lösung langfristig die wirtschaftlichste ist – nicht nur bei den Lizenzkosten."
            }
          ],
          highlight: "Der günstigste Anbieter ist selten der wirtschaftlichste. Wir rechnen ehrlich.",
          deliverables: ["Business-Case-Dokument", "TCO-Vergleich", "ROI-Berechnung", "Sensitivitätsanalyse"]
        }
      },
      "datenqualitaet": {
        title: "Datenqualitäts-Analyse",
        phase: "analyse",
        content: {
          intro: `Schlechte Datenqualität ist eine der Hauptursachen für ERP-Projektprobleme und Go-Live-Verzögerungen. Branchenstudien zeigen: Datenqualitätsprobleme gehören zu den am meisten unterschätzten Risiken. Wir analysieren Ihre Stammdaten rechtzeitig vor der Migration.`,
          sections: [
            {
              label: "Analyse-Bereiche",
              items: [
                "Stammdaten: Kunden, Lieferanten, Materialien, Stücklisten",
                "Bewegungsdaten: Offene Posten, Aufträge, Bestände",
                "Organisationsdaten: Buchungskreise, Werke, Kostenstellen",
                "Customizing-Daten: Einstellungen, Konfiguration, Anpassungen"
              ]
            },
            {
              label: "Qualitätskriterien",
              items: [
                "Vollständigkeit: Fehlen kritische Datenfelder?",
                "Konsistenz: Widersprüche zwischen Systemen?",
                "Aktualität: Veraltete oder obsolete Datensätze?",
                "Dubletten: Mehrfach angelegte Stammdaten?"
              ]
            },
            {
              label: "Branchenstimme",
              text: "Datenqualität ist eine kritische, aber oft übersehene Herausforderung. Unternehmen identifizieren sowohl Genauigkeits- als auch Datentransformationsprobleme beim Verschieben von Legacy-Daten in neue ERP-Umgebungen. (Branchenstudien 2024/2025)"
            }
          ],
          highlight: "Garbage in, garbage out. Datenbereinigung muss VOR der Migration starten, nicht währenddessen.",
          deliverables: ["Datenqualitäts-Report", "Bereinigungskonzept", "Priorisierte Maßnahmenliste", "Migrationsfähigkeits-Bewertung"]
        }
      },
      "erp-evaluation": {
        title: "ERP-Evaluation",
        phase: "analyse",
        content: {
          intro: `Wir evaluieren ERP-Systeme objektiv nach Ihren Kriterien – ohne Vendor-Bias. Das Ergebnis ist eine fundierte Empfehlung, welches System am besten zu Ihren Prozessen passt.`,
          sections: [
            {
              label: "Evaluierte Systeme",
              items: [
                "SAP S/4HANA (Public Cloud, Private Cloud, On-Premise)",
                "Oracle Cloud ERP / NetSuite",
                "Microsoft Dynamics 365 Finance & Operations",
                "Infor CloudSuite (branchenspezifisch)",
                "IFS Cloud, Odoo und weitere"
              ]
            },
            {
              label: "Bewertungskriterien",
              items: [
                "Funktionale Abdeckung Ihrer Anforderungen",
                "Fit-to-Standard vs. Customizing-Bedarf",
                "Total Cost of Ownership über 5-10 Jahre",
                "Implementierungsrisiko und -aufwand",
                "Zukunftsfähigkeit und Innovationskraft"
              ]
            }
          ],
          highlight: "Wir empfehlen das ERP, das zu Ihnen passt – nicht das, an dem wir am meisten verdienen.",
          deliverables: ["ERP-Vergleichsmatrix", "Scoring nach Ihren Kriterien", "Empfehlung mit Begründung", "Shortlist für PoC"]
        }
      },
      "roadmap": {
        title: "Transformations-Roadmap",
        phase: "analyse",
        content: {
          intro: `Die Roadmap ist Ihr Fahrplan für die ERP-Transformation. Wir definieren Meilensteine, identifizieren Quick Wins und planen die Transformation in machbaren Schritten.`,
          sections: [
            {
              label: "Roadmap-Elemente",
              items: [
                "Phasenplan mit realistischen Zeitrahmen",
                "Meilensteine und Quality Gates",
                "Quick Wins für frühe Erfolge",
                "Abhängigkeiten und kritischer Pfad",
                "Ressourcenplanung und Budget-Allokation"
              ]
            },
            {
              label: "Szenarien",
              text: "Wir entwickeln verschiedene Szenarien (konservativ, optimistisch, aggressiv) mit unterschiedlichen Zeit- und Budgetrahmen, damit Sie eine informierte Entscheidung treffen können."
            }
          ],
          highlight: "Eine realistische Roadmap ist wichtiger als eine optimistische. Wir planen ehrlich.",
          deliverables: ["Transformations-Roadmap", "Meilensteinplan", "Quick-Win-Liste", "Ressourcenplan"]
        }
      },

      // === PHASE 2: KONZEPTION ===
      "soll-prozesse": {
        title: "Soll-Prozess-Definition",
        phase: "konzeption",
        content: {
          intro: `Auf Basis der Ist-Analyse definieren wir Ihre optimierten Soll-Prozesse. Der Fokus liegt auf Fit-to-Standard: Wir nutzen ERP-Best-Practices, wo immer möglich.`,
          sections: [
            {
              label: "Vorgehen",
              items: [
                "Definition der Soll-Prozesse mit Ihren Fachbereichen",
                "Integration von ERP-Best-Practices und Branchenstandards",
                "Fit-to-Standard-Prüfung: Passt der Prozess zum ERP-Standard?",
                "Identifikation unvermeidbarer Anpassungen",
                "Dokumentation in BPMN 2.0"
              ]
            },
            {
              label: "Fit-to-Standard-Prinzip",
              text: "Jede Abweichung vom Standard verursacht Kosten – bei der Implementierung, bei Updates, beim Support. Wir maximieren Fit-to-Standard und minimieren Customizing."
            }
          ],
          highlight: "80% Standard, 20% Anpassung ist das Ziel. Nicht umgekehrt.",
          deliverables: ["Soll-Prozess-Modelle", "Fit-to-Standard-Report", "Customizing-Anforderungen", "Prozess-KPIs"]
        }
      },
      "gap-analyse": {
        title: "Gap-Analyse",
        phase: "konzeption",
        content: {
          intro: `Die Gap-Analyse zeigt das Delta zwischen Ihren Soll-Prozessen und dem ERP-Standard. Wir bewerten den ERP-Fit und identifizieren den Customizing-Bedarf.`,
          sections: [
            {
              label: "Gap-Kategorien",
              items: [
                "Fit: Der ERP-Standard erfüllt die Anforderung",
                "Gap mit Workaround: Anforderung erfüllbar durch Konfiguration/Workaround",
                "Gap mit Customizing: Entwicklung erforderlich",
                "Gap mit Add-On: Partnerlösung oder Drittanbieter empfohlen",
                "Showstopper: Kritische Anforderung nicht erfüllbar"
              ]
            },
            {
              label: "Bewertung",
              text: "Jeder Gap wird nach Kritikalität, Aufwand und Risiko bewertet. Das Ergebnis ist eine priorisierte Liste von Entscheidungen, die Sie vor der Implementierung treffen müssen."
            }
          ],
          highlight: "Gaps früh erkennen kostet wenig. Gaps spät erkennen kostet viel.",
          deliverables: ["Gap-Report", "Entscheidungsmatrix", "Customizing-Backlog", "Risikobewertung"]
        }
      },
      "loesungsdesign": {
        title: "Lösungsdesign",
        phase: "konzeption",
        content: {
          intro: `Das Lösungsdesign ist der technische Blueprint für Ihre ERP-Implementierung. Wir definieren Architektur, Konfiguration und Customizing im Detail – mit dem Ziel maximaler Standardisierung.`,
          sections: [
            {
              label: "Design-Elemente",
              items: [
                "System-Architektur: Landscape, Instanzen, Mandanten",
                "Organisations-Strukturen: Buchungskreise, Werke, Vertriebswege",
                "Master Data Design: Stammdaten-Modell, Nummernkreise",
                "Prozess-Konfiguration: Einstellungen pro Prozess",
                "Erweiterungen: Custom Code, Enhancements, Add-Ons"
              ]
            },
            {
              label: "Clean-Architecture-Prinzip",
              text: "Wir folgen dem Clean-Architecture-Prinzip: Der ERP-Kern bleibt sauber und standardnah, Erweiterungen werden in definierten Extension Points oder als Side-by-Side-Lösungen umgesetzt. Das sichert Update-Fähigkeit und reduziert technische Schulden."
            }
          ],
          highlight: "Ein sauberes Design heute spart Millionen bei zukünftigen Updates.",
          deliverables: ["Solution Design Document", "Architektur-Blueprint", "Konfigurationskonzept", "Extension-Konzept"]
        }
      },
      "integrationskonzept": {
        title: "Integrationskonzept",
        phase: "konzeption",
        content: {
          intro: `Das ERP ist das Herzstück Ihrer IT-Landschaft. Integration ist mit 49% eine der Top-3-Herausforderungen bei ERP-Projekten. Das Integrationskonzept definiert, wie das ERP mit allen anderen Systemen kommuniziert.`,
          sections: [
            {
              label: "Integrationsbereiche",
              items: [
                "CRM-Integration: Kunden, Opportunities, Aufträge",
                "E-Commerce: Webshop-Anbindung, Produktdaten",
                "Produktion: MES, Maschinendaten, IoT",
                "Logistik: WMS, TMS, Carrier-Anbindung",
                "Finance: Banken, Zahlungsverkehr, Konsolidierung",
                "HR: Personalwirtschaft, Zeiterfassung, Payroll"
              ]
            },
            {
              label: "Integrationsmuster",
              text: "Wir definieren für jede Schnittstelle das optimale Integrationsmuster: Synchron vs. Asynchron, API vs. File, Point-to-Point vs. Middleware (iPaaS)."
            }
          ],
          highlight: "Schlechte Integration ist der versteckte Kostentreiber vieler ERP-Projekte.",
          deliverables: ["Integrations-Architektur", "Schnittstellen-Katalog", "API-Strategie", "Middleware-Empfehlung"]
        }
      },
      "change-readiness": {
        title: "Change Readiness",
        phase: "konzeption",
        content: {
          intro: `Die beste Technik nützt nichts, wenn die Menschen nicht mitziehen. McKinsey zeigt: Unternehmen mit einer klaren Change-Story haben eine 3,1-mal höhere Erfolgsrate. Change Readiness bereitet Ihre Organisation auf die Transformation vor.`,
          sections: [
            {
              label: "Analyse-Elemente",
              items: [
                "Stakeholder-Mapping: Wer sind die Betroffenen?",
                "Change Impact Assessment: Wie stark verändert sich die Arbeit?",
                "Widerstandsanalyse: Wo ist mit Widerstand zu rechnen?",
                "Kommunikationsbedarfe: Wer muss was wann wissen?",
                "Trainingsbedarfe: Welche Skills fehlen?"
              ]
            },
            {
              label: "Change-Strategie",
              text: "Basierend auf der Analyse entwickeln wir eine maßgeschneiderte Change-Strategie mit Kommunikationsplan, Stakeholder-Engagement und Trainingskonzept."
            },
            {
              label: "Forschungsergebnis",
              text: "Projekte mit gutem oder exzellentem Executive-Sponsor-Zugang haben eine Erfolgsquote von 72%. (Prosci Best Practices Research)"
            }
          ],
          highlight: "Technik-Projekte scheitern selten an der Technik. Sie scheitern an den Menschen.",
          deliverables: ["Stakeholder-Map", "Change Impact Matrix", "Kommunikationsplan", "Trainingskonzept"]
        }
      },

      // === PHASE 3: UMSETZUNG ===
      "datenmigration": {
        title: "Datenmigration",
        phase: "umsetzung",
        content: {
          intro: `Die Datenmigration ist oft der kritischste Teil der Transformation. Datenqualitätsprobleme gehören zu den Hauptursachen für Go-Live-Verzögerungen. Wir begleiten die Migration von der Konzeption über Testläufe bis zur produktiven Übernahme.`,
          sections: [
            {
              label: "Migrations-Phasen",
              items: [
                "Migrationskonzept: Strategie, Scope, Mapping",
                "Datenbereinigung: Qualitätsprobleme vor Migration beheben",
                "Entwicklung: ETL-Prozesse, Transformationsregeln",
                "Testmigration: Iterative Tests mit Validierung",
                "Produktivmigration: Cutover-Durchführung",
                "Validierung: Vollständigkeit und Korrektheit prüfen"
              ]
            },
            {
              label: "Unsere Rolle",
              text: "Wir erstellen das Migrationskonzept, begleiten die Datenbereinigung, validieren Testmigrationen und stellen sicher, dass die Produktivmigration vollständig und korrekt erfolgt."
            }
          ],
          highlight: "Eine Migration kann man nicht rückgängig machen. Wir machen sie gleich richtig.",
          deliverables: ["Migrationskonzept", "Mapping-Dokumentation", "Testmigrations-Reports", "Validierungsprotokolle"]
        }
      },
      "testmanagement": {
        title: "Testmanagement",
        phase: "umsetzung",
        content: {
          intro: `Umfassendes Testing ist der Schlüssel zur Qualitätssicherung. Wir steuern die Teststrategie und koordinieren alle Testphasen bis zum UAT.`,
          sections: [
            {
              label: "Testarten",
              items: [
                "Unit Tests: Einzelne Funktionen und Customizing",
                "Integrationstests: Prozesse end-to-end",
                "Regressionstests: Bestehende Funktionen nach Änderungen",
                "Performance Tests: Last und Skalierbarkeit",
                "User Acceptance Tests (UAT): Abnahme durch Fachbereiche"
              ]
            },
            {
              label: "Defect Management",
              text: "Wir etablieren ein strukturiertes Defect Management mit Kategorisierung, Priorisierung und Tracking. Kritische Defects werden eskaliert und vor Go-Live gelöst."
            }
          ],
          highlight: "Was nicht getestet wurde, funktioniert nicht. Wir testen gründlich.",
          deliverables: ["Teststrategie", "Testfälle", "Test-Reports", "Defect-Tracking"]
        }
      },
      "change-management": {
        title: "Change Management",
        phase: "umsetzung",
        content: {
          intro: `Change Management begleitet Ihre Mitarbeiter durch die Transformation. Prosci-Forschung zeigt: Projekte mit exzellentem Change Management sind 7-mal wahrscheinlicher erfolgreich. Wir setzen die Change-Strategie um und managen aktiv den Widerstand.`,
          sections: [
            {
              label: "Aktivitäten",
              items: [
                "Stakeholder-Kommunikation: Regelmäßige Updates, Townhalls",
                "Multiplikatoren-Netzwerk: Change Agents in den Fachbereichen",
                "Quick Wins kommunizieren: Frühe Erfolge sichtbar machen",
                "Widerstandsmanagement: Bedenken ernst nehmen, adressieren",
                "Feedback-Schleifen: Kontinuierlich Rückmeldung einholen"
              ]
            },
            {
              label: "Adoption messen",
              text: "Wir messen die User Adoption mit definierten KPIs und passen die Change-Maßnahmen bei Bedarf an. Das Ziel: Hohe Akzeptanz und produktive Nutzung ab Go-Live."
            },
            {
              label: "Forschungsergebnis",
              text: "Mit effektivem Change Management sehen Unternehmen operative Verbesserungen und finanzielle Erträge Monate früher als bei Implementierungen, die die menschliche Seite des Wandels vernachlässigen. (Prosci Research)"
            }
          ],
          highlight: "Change Management ist kein Nice-to-have. Es ist erfolgskritisch.",
          deliverables: ["Kommunikationsmaterial", "Change-KPIs", "Feedback-Reports", "Adoption-Tracking"]
        }
      },
      "training": {
        title: "Training & Enablement",
        phase: "umsetzung",
        content: {
          intro: `Gut geschulte Anwender sind produktiv ab Tag 1. Gartner warnt: Geringe Endanwender-Akzeptanz entsteht, wenn Anwender die Gründe für die ERP-Implementierung nicht verstehen. Wir entwickeln und koordinieren das Schulungskonzept für alle Anwendergruppen.`,
          sections: [
            {
              label: "Trainingskonzept",
              items: [
                "Zielgruppenanalyse: Wer braucht welches Training?",
                "Curriculum-Design: Inhalte, Reihenfolge, Dauer",
                "Train-the-Trainer: Interne Trainer ausbilden",
                "Schulungsmaterial: Handbücher, Quick Guides, Videos",
                "Schulungsdurchführung: Präsenz, Online, Blended"
              ]
            },
            {
              label: "Nachhaltigkeit",
              text: "Training ist kein einmaliges Event. Wir etablieren eine Struktur für kontinuierliches Lernen und Onboarding neuer Mitarbeiter nach Go-Live."
            },
            {
              label: "Forschungsergebnis",
              text: "McKinsey: Die Entwicklung von Talenten und Skills in der gesamten Organisation ist einer der wichtigsten Erfolgsfaktoren bei digitalen Transformationen."
            }
          ],
          highlight: "In Schulung zu investieren zahlt sich 10x zurück. An Schulung zu sparen rächt sich.",
          deliverables: ["Schulungskonzept", "Trainingsmaterial", "Train-the-Trainer", "Lernplattform-Setup"]
        }
      },
      "qualitaetssicherung": {
        title: "Qualitätssicherung (QA)",
        phase: "umsetzung",
        content: {
          intro: `Als unabhängiger Partner sichern wir die Qualität der Implementierung. Laut Prosci erreichen nur 55% der ERP-Projekte ihre Ziele – unabhängige QA erhöht Ihre Erfolgschancen deutlich.`,
          sections: [
            {
              label: "QA-Aktivitäten",
              items: [
                "Unabhängige Reviews: Design, Code, Konfiguration",
                "SI-Kontrolle: Liefert der Integrator wie vereinbart?",
                "Quality Gates: Freigabekriterien definieren und prüfen",
                "Eskalationsmanagement: Probleme früh adressieren",
                "Claim Management: Ihre Interessen bei Abweichungen vertreten"
              ]
            },
            {
              label: "Warum unabhängige QA?",
              text: "Der SI kontrolliert sich selbst nicht objektiv. Eine unabhängige QA deckt Probleme auf, die der SI nicht sieht oder nicht sehen will. Das verhindert böse Überraschungen beim Go-Live."
            }
          ],
          highlight: "Unabhängige QA ist Ihre Versicherung gegen SI-Blindheit.",
          deliverables: ["QA-Reports", "Review-Protokolle", "Mängellisten", "Abnahmeempfehlungen"]
        }
      },
      "go-live": {
        title: "Go-Live Management",
        phase: "umsetzung",
        content: {
          intro: `Der Go-Live ist der kritischste Moment der Transformation. Wir planen den Cutover detailliert und stellen sicher, dass alle Fallback-Szenarien vorbereitet sind.`,
          sections: [
            {
              label: "Cutover-Planung",
              items: [
                "Cutover-Plan: Minutengenaue Planung aller Aktivitäten",
                "Verantwortlichkeiten: Wer macht was wann?",
                "Kommunikationsplan: Information an alle Stakeholder",
                "Fallback-Szenarien: Was tun, wenn etwas schiefgeht?",
                "Go/No-Go-Entscheidung: Klare Kriterien definiert"
              ]
            },
            {
              label: "Go-Live-Checklisten",
              text: "Wir arbeiten mit umfassenden Checklisten, die alle Voraussetzungen für einen erfolgreichen Go-Live abprüfen. Kein kritischer Punkt wird übersehen."
            }
          ],
          highlight: "Ein Go-Live lässt sich nicht wiederholen. Wir bereiten ihn akribisch vor.",
          deliverables: ["Cutover-Plan", "Go-Live-Checklisten", "Fallback-Prozeduren", "Go/No-Go-Protokoll"]
        }
      },

      // === PHASE 4: BETRIEB ===
      "hypercare": {
        title: "Hypercare",
        phase: "betrieb",
        content: {
          intro: `Die ersten 4-12 Wochen nach Go-Live sind kritisch. Hypercare bietet intensive Betreuung mit schneller Problemlösung und direktem User Support.`,
          sections: [
            {
              label: "Hypercare-Leistungen",
              items: [
                "Erweiterter Support: Schnelle Reaktionszeiten, mehr Kapazität",
                "Vor-Ort-Präsenz: Berater an kritischen Standorten",
                "Floor Walking: Direkte Unterstützung der Anwender",
                "Incident Management: Schnelle Problemanalyse und -lösung",
                "Tägliche Stand-ups: Statusübersicht und Priorisierung"
              ]
            },
            {
              label: "Dauer",
              text: "Die Hypercare-Phase dauert typischerweise 4-12 Wochen, abhängig von Projektgröße und Komplexität. Wir definieren klare Exit-Kriterien für den Übergang in den Regelbetrieb."
            }
          ],
          highlight: "Die ersten Wochen entscheiden über die langfristige Akzeptanz. Wir sind da.",
          deliverables: ["Hypercare-Reports", "Incident-Logs", "Known Issues Liste", "Handover an Support"]
        }
      },
      "optimierung": {
        title: "Kontinuierliche Optimierung",
        phase: "betrieb",
        content: {
          intro: `Nach dem Go-Live ist vor der Optimierung. Wir helfen Ihnen, das volle Potenzial Ihres ERP-Systems auszuschöpfen und kontinuierlich zu verbessern.`,
          sections: [
            {
              label: "Optimierungsbereiche",
              items: [
                "Prozessoptimierung: Basierend auf echten Nutzungsdaten",
                "Feature-Aktivierung: Neue Funktionen nutzen",
                "Automatisierung: Manuelle Tätigkeiten reduzieren",
                "Reporting: Analytics und Dashboards verbessern",
                "Performance: System-Tuning und Optimierung"
              ]
            },
            {
              label: "Quartalsreviews",
              text: "Wir empfehlen quartalsweise Reviews, um Optimierungspotenziale systematisch zu identifizieren und einen priorisierten Backlog zu pflegen."
            }
          ],
          highlight: "Ein ERP ist nie fertig. Kontinuierliche Optimierung maximiert den ROI.",
          deliverables: ["Optimierungs-Backlog", "Nutzungsanalysen", "Feature-Empfehlungen", "Verbesserungs-Roadmap"]
        }
      },
      "managed-services": {
        title: "Managed Services",
        phase: "betrieb",
        content: {
          intro: `Langfristiger Betrieb und Support für Ihr ERP-System. Wir übernehmen Application Management, Monitoring und Incident Management als laufenden Service.`,
          sections: [
            {
              label: "Service-Umfang",
              items: [
                "Application Management: Wartung und Pflege des Systems",
                "Incident Management: Störungsbehebung nach definierten SLAs",
                "Change Management: Änderungen kontrolliert umsetzen",
                "Monitoring: Proaktive Überwachung und Alerting",
                "Release Management: Updates und Patches einspielen"
              ]
            },
            {
              label: "Service-Modelle",
              text: "Wir bieten flexible Service-Modelle: Von punktueller Unterstützung bis zum Full-Service-Betrieb. Sie wählen den Umfang, der zu Ihnen passt."
            }
          ],
          highlight: "Professioneller Betrieb sichert Stabilität und Verfügbarkeit. Wir kümmern uns.",
          deliverables: ["SLA-Reports", "Incident-Statistiken", "Change-Logs", "Verfügbarkeitsberichte"]
        }
      },
      "rollout-support": {
        title: "Rollout Support",
        phase: "betrieb",
        content: {
          intro: `Nach dem erfolgreichen Pilot folgt der Rollout auf weitere Standorte, Länder oder Gesellschaften. Wir unterstützen mit Template-Ansätzen und lokaler Anpassung.`,
          sections: [
            {
              label: "Rollout-Ansatz",
              items: [
                "Template-Definition: Best Practices aus dem Pilot",
                "Delta-Analyse: Was ist lokal anders?",
                "Lokalisierung: Sprache, Recht, Steuern",
                "Schulung: Train-the-Trainer vor Ort",
                "Go-Live-Begleitung: Support bei jedem Rollout"
              ]
            },
            {
              label: "Skalierung",
              text: "Mit jedem Rollout wird der Prozess effizienter. Wir etablieren ein Rollout-Playbook, das kontinuierlich verbessert wird."
            }
          ],
          highlight: "Ein gutes Template ist die Basis für effiziente Rollouts.",
          deliverables: ["Rollout-Playbook", "Template-Dokumentation", "Lokalisierungs-Checklisten", "Lessons Learned"]
        }
      },

      // === NUTZEN ===
      "nutzen-cfo": {
        title: "Nutzen für CFO & Finance",
        phase: "nutzen",
        content: {
          intro: `Als CFO oder Finance-Verantwortlicher tragen Sie die Budgetverantwortung für die ERP-Transformation. Laut Branchenstudien überschreiten 55% der ERP-Projekte das Budget. Wir helfen Ihnen, das Investment abzusichern.`,
          sections: [
            {
              label: "Ihr Nutzen",
              items: [
                "Realistischer Business Case mit TCO-Transparenz",
                "Budgetsicherheit durch unabhängige QA",
                "ROI-Beschleunigung durch Fit-to-Standard",
                "Vermeidung teurer Customizations",
                "Objektive Kontrolle des Systemintegrators"
              ]
            },
            {
              label: "Typische Ergebnisse",
              text: "Unsere Kunden berichten von 20-30% Zeitgewinn durch bessere Vorbereitung und 30-50% schnellerem ROI durch konsequenten Fit-to-Standard-Ansatz."
            },
            {
              label: "Forschungsergebnis",
              text: "Prosci: Nur 55% der ERP-Projekte erreichen oder übertreffen ihre Ziele. Mit unabhängiger Beratung erhöhen Sie Ihre Erfolgschancen signifikant."
            }
          ],
          highlight: "Wir schützen Ihr Budget und beschleunigen Ihren ROI.",
          deliverables: ["Business Case", "TCO-Analyse", "Budget-Monitoring", "ROI-Tracking"]
        }
      },
      "nutzen-cio": {
        title: "Nutzen für CIO & IT",
        phase: "nutzen",
        content: {
          intro: `Als CIO oder IT-Verantwortlicher tragen Sie die technische Verantwortung für die ERP-Transformation. Wir unterstützen Sie mit objektiver Expertise und Multi-ERP-Know-how.`,
          sections: [
            {
              label: "Ihr Nutzen",
              items: [
                "Objektive ERP-Evaluation ohne Vendor-Bias",
                "Clean Architecture Beratung für Update-Fähigkeit",
                "Integrations- und API-Strategie",
                "Technische Risikominimierung",
                "Unabhängige Qualitätssicherung der Implementierung"
              ]
            },
            {
              label: "Multi-ERP Know-how",
              text: "Wir kennen SAP, Oracle, Microsoft, Infor und andere aus zahlreichen Projekten. Dieses Cross-ERP-Wissen hilft, die richtige Entscheidung zu treffen – unabhängig vom Hersteller."
            }
          ],
          highlight: "Wir bringen Multi-ERP-Expertise ohne Vendor-Abhängigkeit.",
          deliverables: ["ERP-Evaluation", "Architektur-Review", "QA-Reports", "Integrations-Design"]
        }
      },
      "nutzen-business": {
        title: "Nutzen für Business Owner",
        phase: "nutzen",
        content: {
          intro: `Als Business Owner oder Fachbereichsleiter wollen Sie ein ERP, das Ihre Prozesse optimal unterstützt – nicht umgekehrt. Wir stellen das sicher.`,
          sections: [
            {
              label: "Ihr Nutzen",
              items: [
                "Prozesse verstehen, dann Technologie wählen",
                "Schnellere User Adoption",
                "Weniger Anpassung an das System",
                "Fokus auf Business Value",
                "Ihre Anforderungen im Zentrum"
              ]
            },
            {
              label: "Einbindung der Fachbereiche",
              text: "Wir binden Ihre Fachbereiche von Anfang an ein. Prozessworkshops, Gap-Analysen und UAT werden gemeinsam durchgeführt. Das erhöht Akzeptanz und Qualität."
            }
          ],
          highlight: "Das ERP passt sich an Sie an – nicht Sie ans ERP.",
          deliverables: ["Prozess-Modelle", "Gap-Analysen", "Schulungskonzept", "UAT-Support"]
        }
      },

      // === KONTAKT ===
      "kontakt": {
        title: "Starten Sie jetzt",
        phase: "kontakt",
        content: {
          intro: `Der erste Schritt zu einer erfolgreichen ERP-Transformation ist ein Gespräch. Wir freuen uns auf Sie.`,
          sections: [
            {
              label: "Ihr Weg zu uns",
              items: [
                "Schritt 1: Erstgespräch (60 Min. kostenlos)",
                "Schritt 2: Readiness Check oder Workshop",
                "Schritt 3: Projektstart binnen 2-4 Wochen"
              ]
            },
            {
              label: "Ihr Ansprechpartner",
              text: "Marcel Wagner\nERP Transformation Advisory Lead\nmarcel.wagner@timetoact-group.com"
            }
          ],
          highlight: "\"Wir verkaufen keine Lizenzen. Wir liefern Projekterfolg.\"",
          deliverables: ["Kostenloses Erstgespräch", "Schneller Start", "Erfahrene Berater", "Messbare Ergebnisse"]
        }
      }
    };

    const topicLists = {
      analyse: [
        { id: "process-mapping", label: "Process Mapping" },
        { id: "readiness-assessment", label: "Readiness Assessment" },
        { id: "business-case", label: "Business Case & ROI" },
        { id: "datenqualitaet", label: "Datenqualitäts-Analyse" },
        { id: "erp-evaluation", label: "ERP-Evaluation" },
        { id: "roadmap", label: "Transformations-Roadmap" }
      ],
      konzeption: [
        { id: "soll-prozesse", label: "Soll-Prozess-Definition" },
        { id: "gap-analyse", label: "Gap-Analyse" },
        { id: "loesungsdesign", label: "Lösungsdesign" },
        { id: "integrationskonzept", label: "Integrationskonzept" },
        { id: "change-readiness", label: "Change Readiness" }
      ],
      umsetzung: [
        { id: "datenmigration", label: "Datenmigration" },
        { id: "testmanagement", label: "Testmanagement" },
        { id: "change-management", label: "Change Management" },
        { id: "training", label: "Training & Enablement" },
        { id: "qualitaetssicherung", label: "Qualitätssicherung (QA)" },
        { id: "go-live", label: "Go-Live Management" }
      ],
      betrieb: [
        { id: "hypercare", label: "Hypercare" },
        { id: "optimierung", label: "Kontinuierliche Optimierung" },
        { id: "managed-services", label: "Managed Services" },
        { id: "rollout-support", label: "Rollout Support" }
      ],
      info: [
        { id: "warum-advisory", label: "Warum ERP Advisory?" },
        { id: "interessenkonflikte", label: "Interessenkonflikte der SIs" },
        { id: "vorteile", label: "Unsere vier Vorteile" },
        { id: "erp-systeme", label: "Erst Prozesse, dann ERP" }
      ],
      nutzen: [
        { id: "nutzen-cfo", label: "Nutzen für CFO & Finance" },
        { id: "nutzen-cio", label: "Nutzen für CIO & IT" },
        { id: "nutzen-business", label: "Nutzen für Business Owner" }
      ],
      buchung: [
        { id: "kontakt", label: "Starten Sie jetzt" }
      ]
    };

    const viewTitles = {
      analyse: "Phase 1: Analyse",
      konzeption: "Phase 2: Konzeption",
      umsetzung: "Phase 3: Umsetzung",
      betrieb: "Phase 4: Betrieb",
      info: "Warum ERP Transformation Advisory?",
      nutzen: "Nutzen nach Zielgruppe",
      buchung: "Kontakt"
    };

    let currentView = 'home';
    let selectedTopic = null;
    let previousView = null;
    let selectionMode = false;
    let selectedTopics = new Set();
    let topicComplexity = {}; // stores complexity per topic: 'low', 'medium', 'high'

    // Kategorien ohne Auswahlmöglichkeit
    const excludeFromSelection = ['info', 'nutzen', 'buchung'];

    // Personentage-Kalkulation pro Service und Komplexitätsstufe
    const ptMatrix = {
      low: {
        advisory: 5,      // Business-/Fachberater
        technik: 2,       // Technischer Berater
        pm: 1             // Projektleitung
      },
      medium: {
        advisory: 12,
        technik: 5,
        pm: 3
      },
      high: {
        advisory: 25,
        technik: 12,
        pm: 6
      }
    };

    const complexityLabels = {
      low: 'Low',
      medium: 'Mittel',
      high: 'Komplex'
    };

    function setTopicComplexity(topicId, complexity, event) {
      if (event) event.stopPropagation();
      topicComplexity[topicId] = complexity;
      if (!selectedTopics.has(topicId)) {
        selectedTopics.add(topicId);
      }
      render();
    }

    function getTopicComplexity(topicId) {
      return topicComplexity[topicId] || 'medium';
    }

    function calculateTotalPT() {
      let totals = {
        advisory: 0,
        technik: 0,
        pm: 0,
        gesamtPT: 0
      };
      
      selectedTopics.forEach(topicId => {
        const complexity = getTopicComplexity(topicId);
        const pt = ptMatrix[complexity];
        totals.advisory += pt.advisory;
        totals.technik += pt.technik;
        totals.pm += pt.pm;
      });
      
      totals.gesamtPT = totals.advisory + totals.technik + totals.pm;
      
      return totals;
    }

    function renderCalculationPanel() {
      if (selectedTopics.size === 0) return '';
      
      const totals = calculateTotalPT();
      
      // Geschätzte Projektdauer: Annahme 2-3 Berater parallel
      const geschaetzteDauer = Math.ceil(totals.gesamtPT / 2.5);
      
      let breakdownHtml = '';
      selectedTopics.forEach(topicId => {
        const topic = detailContent[topicId];
        const complexity = getTopicComplexity(topicId);
        const pt = ptMatrix[complexity];
        if (topic) {
          breakdownHtml += `
            <div class="selected-topic-row">
              <span class="selected-topic-name">${topic.title}</span>
              <span style="font-size: 10px; color: var(--tta-orange); min-width: 50px;">${pt.advisory + pt.technik + pt.pm} PT</span>
              <div class="complexity-selector">
                <button class="complexity-btn low ${complexity === 'low' ? 'active' : ''}" 
                        onclick="setTopicComplexity('${topicId}', 'low', event)">Low</button>
                <button class="complexity-btn medium ${complexity === 'medium' ? 'active' : ''}" 
                        onclick="setTopicComplexity('${topicId}', 'medium', event)">Mittel</button>
                <button class="complexity-btn high ${complexity === 'high' ? 'active' : ''}" 
                        onclick="setTopicComplexity('${topicId}', 'high', event)">Komplex</button>
              </div>
            </div>
          `;
        }
      });

      return `
        <div class="calculation-panel">
          <div class="calculation-title">📊 Aufwandsschätzung (Richtwerte)</div>
          <div class="calculation-grid">
            <div class="calc-item">
              <div class="calc-label">Business Beratung</div>
              <div class="calc-value">${totals.advisory}</div>
              <div class="calc-unit">Personentage</div>
            </div>
            <div class="calc-item">
              <div class="calc-label">Technische Beratung</div>
              <div class="calc-value">${totals.technik}</div>
              <div class="calc-unit">Personentage</div>
            </div>
            <div class="calc-item">
              <div class="calc-label">Projektleitung</div>
              <div class="calc-value">${totals.pm}</div>
              <div class="calc-unit">Personentage</div>
            </div>
            <div class="calc-item">
              <div class="calc-label">Gesamt Aufwand</div>
              <div class="calc-value">${totals.gesamtPT}</div>
              <div class="calc-unit">Personentage</div>
            </div>
            <div class="calc-item">
              <div class="calc-label">Geschätzte Dauer</div>
              <div class="calc-value">~${geschaetzteDauer}</div>
              <div class="calc-unit">Wochen</div>
            </div>
          </div>
          <div class="calc-breakdown">
            <div class="calc-breakdown-title">Ausgewählte Services (${selectedTopics.size}) – Komplexität anpassen:</div>
            ${breakdownHtml}
          </div>
          <div style="font-size: 9px; color: rgba(255,255,255,0.5); margin-top: 12px; text-align: center;">
            * Richtwerte basierend auf Erfahrungswerten. Individuelle Angebote nach Anforderungsanalyse.
          </div>
        </div>
      `;
    }

    function toggleSelectionMode() {
      selectionMode = !selectionMode;
      if (!selectionMode) {
        selectedTopics.clear();
        topicComplexity = {};
      }
      render();
    }

    function toggleTopicSelection(topicId, event) {
      if (event) event.stopPropagation();
      if (selectedTopics.has(topicId)) {
        selectedTopics.delete(topicId);
      } else {
        selectedTopics.add(topicId);
      }
      render();
    }

    function clearSelection() {
      selectedTopics.clear();
      topicComplexity = {};
      render();
    }

    async function downloadSelectedTopics() {
      if (selectedTopics.size === 0) {
        alert('Bitte wählen Sie mindestens ein Thema aus.');
        return;
      }

      const { Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell, 
              Header, Footer, AlignmentType, BorderStyle, WidthType, 
              HeadingLevel, ShadingType, LevelFormat, PageNumber } = docx;

      const totals = calculateTotalPT();
      const geschaetzteDauer = Math.ceil(totals.gesamtPT / 2.5);
      const today = new Date().toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', year: 'numeric' });

      // Collect all content
      const children = [];
      
      // Title
      children.push(new Paragraph({
        heading: HeadingLevel.TITLE,
        children: [new TextRun({ text: "ERP Transformation Advisory", bold: true, size: 56, color: "212830" })]
      }));
      
      children.push(new Paragraph({
        spacing: { after: 400 },
        children: [new TextRun({ text: "Ausgewählte Services für Ihre ERP-Transformation", size: 24, color: "666666" })]
      }));

      // Calculation table
      const tableBorder = { style: BorderStyle.SINGLE, size: 1, color: "CCCCCC" };
      const cellBorders = { top: tableBorder, bottom: tableBorder, left: tableBorder, right: tableBorder };
      
      const tableRows = [
        new TableRow({
          tableHeader: true,
          children: [
            new TableCell({ borders: cellBorders, width: { size: 3500, type: WidthType.DXA }, shading: { fill: "098F9B", type: ShadingType.CLEAR }, children: [new Paragraph({ children: [new TextRun({ text: "Service", bold: true, color: "FFFFFF", size: 20 })] })] }),
            new TableCell({ borders: cellBorders, width: { size: 1500, type: WidthType.DXA }, shading: { fill: "098F9B", type: ShadingType.CLEAR }, children: [new Paragraph({ children: [new TextRun({ text: "Komplexität", bold: true, color: "FFFFFF", size: 20 })] })] }),
            new TableCell({ borders: cellBorders, width: { size: 1200, type: WidthType.DXA }, shading: { fill: "098F9B", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: "Business", bold: true, color: "FFFFFF", size: 20 })] })] }),
            new TableCell({ borders: cellBorders, width: { size: 1200, type: WidthType.DXA }, shading: { fill: "098F9B", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: "Technik", bold: true, color: "FFFFFF", size: 20 })] })] }),
            new TableCell({ borders: cellBorders, width: { size: 1000, type: WidthType.DXA }, shading: { fill: "098F9B", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: "PM", bold: true, color: "FFFFFF", size: 20 })] })] }),
            new TableCell({ borders: cellBorders, width: { size: 1000, type: WidthType.DXA }, shading: { fill: "098F9B", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: "Gesamt", bold: true, color: "FFFFFF", size: 20 })] })] }),
          ]
        })
      ];

      selectedTopics.forEach(topicId => {
        const topic = detailContent[topicId];
        const complexity = getTopicComplexity(topicId);
        const pt = ptMatrix[complexity];
        const topicTotal = pt.advisory + pt.technik + pt.pm;
        if (topic) {
          tableRows.push(new TableRow({
            children: [
              new TableCell({ borders: cellBorders, width: { size: 3500, type: WidthType.DXA }, children: [new Paragraph({ children: [new TextRun({ text: topic.title, size: 20 })] })] }),
              new TableCell({ borders: cellBorders, width: { size: 1500, type: WidthType.DXA }, children: [new Paragraph({ children: [new TextRun({ text: complexityLabels[complexity], size: 20 })] })] }),
              new TableCell({ borders: cellBorders, width: { size: 1200, type: WidthType.DXA }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: pt.advisory + " PT", size: 20 })] })] }),
              new TableCell({ borders: cellBorders, width: { size: 1200, type: WidthType.DXA }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: pt.technik + " PT", size: 20 })] })] }),
              new TableCell({ borders: cellBorders, width: { size: 1000, type: WidthType.DXA }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: pt.pm + " PT", size: 20 })] })] }),
              new TableCell({ borders: cellBorders, width: { size: 1000, type: WidthType.DXA }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: topicTotal + " PT", size: 20 })] })] }),
            ]
          }));
        }
      });

      // Total row
      tableRows.push(new TableRow({
        children: [
          new TableCell({ borders: cellBorders, width: { size: 3500, type: WidthType.DXA }, shading: { fill: "E9ECEF", type: ShadingType.CLEAR }, children: [new Paragraph({ children: [new TextRun({ text: "GESAMT", bold: true, size: 20 })] })] }),
          new TableCell({ borders: cellBorders, width: { size: 1500, type: WidthType.DXA }, shading: { fill: "E9ECEF", type: ShadingType.CLEAR }, children: [new Paragraph({ children: [new TextRun({ text: "", size: 20 })] })] }),
          new TableCell({ borders: cellBorders, width: { size: 1200, type: WidthType.DXA }, shading: { fill: "E9ECEF", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: totals.advisory + " PT", bold: true, size: 20 })] })] }),
          new TableCell({ borders: cellBorders, width: { size: 1200, type: WidthType.DXA }, shading: { fill: "E9ECEF", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: totals.technik + " PT", bold: true, size: 20 })] })] }),
          new TableCell({ borders: cellBorders, width: { size: 1000, type: WidthType.DXA }, shading: { fill: "E9ECEF", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: totals.pm + " PT", bold: true, size: 20 })] })] }),
          new TableCell({ borders: cellBorders, width: { size: 1000, type: WidthType.DXA }, shading: { fill: "E9ECEF", type: ShadingType.CLEAR }, children: [new Paragraph({ alignment: AlignmentType.RIGHT, children: [new TextRun({ text: totals.gesamtPT + " PT", bold: true, size: 20 })] })] }),
        ]
      }));

      children.push(new Paragraph({
        spacing: { before: 200 },
        children: [new TextRun({ text: "AUFWANDSSCHÄTZUNG (RICHTWERTE)", bold: true, size: 24, color: "098F9B" })]
      }));

      children.push(new Table({
        columnWidths: [3500, 1500, 1200, 1200, 1000, 1000],
        rows: tableRows
      }));

      children.push(new Paragraph({
        spacing: { before: 200, after: 100 },
        alignment: AlignmentType.RIGHT,
        children: [new TextRun({ text: `Gesamt: ${totals.gesamtPT} Personentage · Geschätzte Dauer: ~${geschaetzteDauer} Wochen`, bold: true, size: 22, color: "DA5500" })]
      }));

      children.push(new Paragraph({
        spacing: { after: 400 },
        children: [new TextRun({ text: "* Richtwerte basierend auf Erfahrungswerten. Individuelle Angebote nach Anforderungsanalyse.", italics: true, size: 18, color: "666666" })]
      }));

      // Service details
      let bulletIndex = 0;
      const numberingConfig = [];
      
      selectedTopics.forEach(topicId => {
        const topic = detailContent[topicId];
        const complexity = getTopicComplexity(topicId);
        if (topic) {
          // Service title
          children.push(new Paragraph({
            heading: HeadingLevel.HEADING_1,
            spacing: { before: 400, after: 200 },
            children: [
              new TextRun({ text: topic.title, bold: true, size: 28, color: "098F9B" }),
              new TextRun({ text: "  [" + complexityLabels[complexity] + "]", size: 20, color: "666666" })
            ]
          }));

          // Intro
          children.push(new Paragraph({
            spacing: { after: 200 },
            children: [new TextRun({ text: topic.content.intro, size: 22 })]
          }));

          // Sections
          if (topic.content.sections) {
            topic.content.sections.forEach(section => {
              children.push(new Paragraph({
                spacing: { before: 200, after: 100 },
                children: [new TextRun({ text: section.label.toUpperCase(), bold: true, size: 20, color: "DA5500" })]
              }));

              if (section.items) {
                const bulletRef = 'bullet-' + bulletIndex++;
                numberingConfig.push({
                  reference: bulletRef,
                  levels: [{ level: 0, format: LevelFormat.BULLET, text: "•", alignment: AlignmentType.LEFT, style: { paragraph: { indent: { left: 720, hanging: 360 } } } }]
                });
                section.items.forEach(item => {
                  children.push(new Paragraph({
                    numbering: { reference: bulletRef, level: 0 },
                    children: [new TextRun({ text: item, size: 20 })]
                  }));
                });
              }

              if (section.text) {
                children.push(new Paragraph({
                  spacing: { after: 100 },
                  children: [new TextRun({ text: section.text, size: 20 })]
                }));
              }
            });
          }

          // Highlight
          if (topic.content.highlight) {
            children.push(new Paragraph({
              spacing: { before: 200, after: 200 },
              indent: { left: 400 },
              border: { left: { style: BorderStyle.SINGLE, size: 24, color: "DA5500" } },
              children: [new TextRun({ text: topic.content.highlight, italics: true, size: 20, color: "333333" })]
            }));
          }

          // Deliverables
          if (topic.content.deliverables && topic.content.deliverables.length > 0) {
            children.push(new Paragraph({
              spacing: { before: 100 },
              shading: { fill: "F5F5F5", type: ShadingType.CLEAR },
              children: [
                new TextRun({ text: "DELIVERABLES: ", bold: true, size: 18, color: "DA5500" }),
                new TextRun({ text: topic.content.deliverables.join(" · "), size: 18 })
              ]
            }));
          }
        }
      });

      // Create document
      const doc = new Document({
        styles: {
          default: { document: { run: { font: "Arial", size: 22 } } },
          paragraphStyles: [
            { id: "Title", name: "Title", basedOn: "Normal", run: { size: 56, bold: true, color: "212830", font: "Arial" }, paragraph: { spacing: { before: 0, after: 120 } } },
            { id: "Heading1", name: "Heading 1", basedOn: "Normal", next: "Normal", quickFormat: true, run: { size: 28, bold: true, color: "098F9B", font: "Arial" }, paragraph: { spacing: { before: 400, after: 200 } } },
          ]
        },
        numbering: { config: numberingConfig },
        sections: [{
          properties: {
            page: { margin: { top: 1440, right: 1440, bottom: 1440, left: 1440 } }
          },
          headers: {
            default: new Header({
              children: [new Paragraph({
                alignment: AlignmentType.RIGHT,
                children: [
                  new TextRun({ text: "TIMETOACT", bold: true, size: 20, color: "212830" }),
                  new TextRun({ text: "GROUP", bold: true, size: 20, color: "DA5500" }),
                  new TextRun({ text: "  |  ERP Transformation Advisory", size: 18, color: "666666" })
                ]
              })]
            })
          },
          footers: {
            default: new Footer({
              children: [new Paragraph({
                alignment: AlignmentType.CENTER,
                children: [
                  new TextRun({ text: "© 2025 TIMETOACT GROUP · Marcel Wagner · marcel.wagner@timetoact-group.com · Seite ", size: 16, color: "666666" }),
                  new TextRun({ children: [PageNumber.CURRENT], size: 16, color: "666666" }),
                  new TextRun({ text: " von ", size: 16, color: "666666" }),
                  new TextRun({ children: [PageNumber.TOTAL_PAGES], size: 16, color: "666666" })
                ]
              })]
            })
          },
          children: children
        }]
      });

      // Generate and download
      const blob = await Packer.toBlob(doc);
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'TIMETOACT_ERP_Advisory_Services_' + today.replace(/\./g, '-') + '.docx';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function render() {
      const app = document.getElementById('app');
      if (selectedTopic && detailContent[selectedTopic]) {
        app.innerHTML = renderDetailView();
      } else if (currentView !== 'home') {
        app.innerHTML = renderTopicGrid();
      } else {
        app.innerHTML = renderHome();
      }
    }

    function renderHome() {
      return `
        <div class="header fade-in">
          <div class="logo-container">
            <div class="logo-text">We Drive Digital Innovation & Operational Excellence</div>
            <div class="logo-main">TIMETOACT<span>GROUP</span></div>
          </div>
          <div class="tagline">
            ERP Transformation Advisory
            <div class="tagline-highlight">
              <span>We Care.</span>
              <span>We Drive.</span>
              <span>We Deliver.</span>
            </div>
          </div>
        </div>

        <!-- Hero Values Section -->
        <div class="hero-values fade-in">
          <div class="hero-values-card">
            <div class="hero-values-title">Wofür wir stehen</div>
            <div class="hero-values-subtitle">Unabhängige ERP-Beratung, die Ihre Interessen in den Mittelpunkt stellt</div>
            
            <div class="values-grid">
              <div class="value-item">
                <div class="value-icon">⚖️</div>
                <div class="value-title">100% Herstellerneutral</div>
                <div class="value-desc">Keine Lizenzen, keine Provisionen. Wir empfehlen das ERP, das zu Ihnen passt.</div>
              </div>
              <div class="value-item">
                <div class="value-icon">🔄</div>
                <div class="value-title">Process First</div>
                <div class="value-desc">Erst Prozesse verstehen und optimieren – dann die passende Technologie wählen.</div>
              </div>
              <div class="value-item">
                <div class="value-icon">👨‍💼</div>
                <div class="value-title">Senior-Only</div>
                <div class="value-desc">Erfahrene Berater mit Cross-ERP-Know-how, produktiv ab Tag 1.</div>
              </div>
              <div class="value-item">
                <div class="value-icon">🧩</div>
                <div class="value-title">Modularer Baukasten</div>
                <div class="value-desc">21 Services in 4 Phasen. Einzeln buchbar, kein Vendor Lock-in.</div>
              </div>
            </div>
            
            <div class="hero-quote">
              <p>„Wir verkaufen keine Lizenzen. Wir liefern Projekterfolg."</p>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="stats-banner fade-in">
            <div class="stat-box">
              <div class="stat-number">20-30%</div>
              <div class="stat-label">Zeitgewinn durch bessere Vorbereitung</div>
            </div>
            <div class="stat-box">
              <div class="stat-number">>95%</div>
              <div class="stat-label">Kundenzufriedenheit (NPS)</div>
            </div>
            <div class="stat-box">
              <div class="stat-number">30-50%</div>
              <div class="stat-label">Schnellerer ROI</div>
            </div>
          </div>

          <div class="main-card fade-in">
            <div class="card-title">ERP Transformation Cockpit</div>
            <div class="card-subtitle">Wir mappen Ihre Prozesse zum passenden ERP – herstellerneutral, senior-only, modular</div>

            <div class="phase-grid">
              <button class="phase-button analyse" onclick="navigate('analyse')">
                <div class="phase-number">1</div>
                <div class="phase-title">ANALYSE</div>
                <div class="phase-count">6 Services</div>
              </button>
              <button class="phase-button konzeption" onclick="navigate('konzeption')">
                <div class="phase-number">2</div>
                <div class="phase-title">KONZEPTION</div>
                <div class="phase-count">5 Services</div>
              </button>
              <button class="phase-button umsetzung" onclick="navigate('umsetzung')">
                <div class="phase-number">3</div>
                <div class="phase-title">UMSETZUNG</div>
                <div class="phase-count">6 Services</div>
              </button>
              <button class="phase-button betrieb" onclick="navigate('betrieb')">
                <div class="phase-number">4</div>
                <div class="phase-title">BETRIEB</div>
                <div class="phase-count">4 Services</div>
              </button>
            </div>

            <div class="section-title">Weitere Informationen</div>

            <div class="info-grid">
              <button class="info-button" onclick="navigate('info')">
                <div class="info-button-title">Warum Advisory?</div>
                <div class="info-button-desc">Interessenkonflikte, unsere Vorteile</div>
              </button>
              <button class="info-button" onclick="navigate('nutzen')">
                <div class="info-button-title">Nutzen</div>
                <div class="info-button-desc">CFO, CIO, Business Owner</div>
              </button>
              <button class="info-button" onclick="navigate('buchung')">
                <div class="info-button-title">Kontakt</div>
                <div class="info-button-desc">Starten Sie jetzt</div>
              </button>
            </div>
          </div>

          ${selectedTopics.size > 0 ? `
          <div class="selection-bar" style="margin-top: 20px;">
            <div class="selection-info">
              Ausgewählte Themen:<span class="selection-count">${selectedTopics.size}</span>
            </div>
            <div class="selection-buttons">
              <button class="download-button" onclick="downloadSelectedTopics()">📥 Als Word speichern</button>
              <button class="clear-button" onclick="clearSelection()">✕ Auswahl löschen</button>
            </div>
          </div>
          ${renderCalculationPanel()}
          ` : ''}
        </div>

        <!-- Success Stories Section -->
        <div class="success-section fade-in">
          <div class="success-section-title">Was unsere <span>Kunden</span> sagen</div>
          
          <div class="success-grid">
            <div class="success-card featured">
              <div class="success-badge">Referenz</div>
              <div class="success-logo">Berner Group</div>
              <div class="success-quote">„Die TIMETOACT GROUP hat uns mit ihrer herstellerneutralen Beratung überzeugt. Endlich ein Partner, der unsere Prozesse versteht und nicht nur Lizenzen verkaufen will."</div>
              <div class="success-author">
                <div class="success-author-name">René Stukar</div>
                <div class="success-author-role">Teamlead Warehouse Management Solutions & Coordinator Supply Chain Solutions</div>
              </div>
              <div class="success-results">
                <div class="success-result">
                  <div class="success-result-value">25%</div>
                  <div class="success-result-label">Zeitersparnis</div>
                </div>
                <div class="success-result">
                  <div class="success-result-value">On Time</div>
                  <div class="success-result-label">Go-Live</div>
                </div>
              </div>
            </div>
            
            <div class="success-card">
              <div class="success-logo">Fertigungsindustrie</div>
              <div class="success-quote">„Die unabhängige QA hat uns vor einer Budgetüberschreitung von 40% bewahrt. Die Investition in Advisory hat sich mehrfach ausgezahlt."</div>
              <div class="success-author">
                <div class="success-author-name">IT-Leiter</div>
                <div class="success-author-role">Mittelständisches Fertigungsunternehmen, 2.500 MA</div>
              </div>
              <div class="success-results">
                <div class="success-result">
                  <div class="success-result-value">40%</div>
                  <div class="success-result-label">Kosten gespart</div>
                </div>
                <div class="success-result">
                  <div class="success-result-value">6 Mon.</div>
                  <div class="success-result-label">Früher live</div>
                </div>
              </div>
            </div>
            
            <div class="success-card">
              <div class="success-logo">Großhandel</div>
              <div class="success-quote">„Durch das Process Mapping haben wir erkannt, dass unser favorisiertes ERP gar nicht zu uns passt. Das hat uns Millionen erspart."</div>
              <div class="success-author">
                <div class="success-author-name">CFO</div>
                <div class="success-author-role">Internationaler Großhändler, 800 MA</div>
              </div>
              <div class="success-results">
                <div class="success-result">
                  <div class="success-result-value">€2.1M</div>
                  <div class="success-result-label">Ersparnis</div>
                </div>
                <div class="success-result">
                  <div class="success-result-value">Fit-to-Std</div>
                  <div class="success-result-label">Erreicht</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="footer">
            <div class="footer-tagline">
              <span>We Care.</span> <span>We Drive.</span> <span>We Deliver.</span>
            </div>
            <div>© 2025 TIMETOACT GROUP · ERP-unabhängig: SAP · Oracle · Microsoft · Infor · IFS · weitere</div>
          </div>
        </div>
      `;
    }

    function renderTopicGrid() {
      const topics = topicLists[currentView] || [];
      const title = viewTitles[currentView] || currentView;
      const phaseClass = currentView;
      const canSelect = !excludeFromSelection.includes(currentView);
      
      let topicButtons;
      if (selectionMode && canSelect) {
        topicButtons = topics.map(t => {
          const isSelected = selectedTopics.has(t.id);
          return `<div class="topic-item">
            <div class="topic-checkbox-wrapper ${isSelected ? 'checked' : ''}" onclick="toggleTopicSelection('${t.id}', event)">
              <input type="checkbox" class="topic-checkbox" ${isSelected ? 'checked' : ''} onclick="toggleTopicSelection('${t.id}', event)">
            </div>
            <button class="topic-button ${phaseClass} ${isSelected ? 'selected' : ''}" onclick="selectTopic('${t.id}')">${t.label}</button>
          </div>`;
        }).join('');
      } else {
        topicButtons = topics.map(t => 
          `<button class="topic-button ${phaseClass}" onclick="selectTopic('${t.id}')">${t.label}</button>`
        ).join('');
      }

      const selectionBar = selectedTopics.size > 0 ? `
        <div class="selection-bar">
          <div class="selection-info">
            Ausgewählte Themen:<span class="selection-count">${selectedTopics.size}</span>
          </div>
          <div class="selection-buttons">
            <button class="download-button" onclick="downloadSelectedTopics()">📥 Als Word speichern</button>
            <button class="clear-button" onclick="clearSelection()">✕ Auswahl löschen</button>
          </div>
        </div>
        ${renderCalculationPanel()}
      ` : '';

      const selectButton = canSelect ? `
        <div style="display: flex; justify-content: flex-end; margin-bottom: 12px;">
          <button class="toggle-select-button ${selectionMode ? 'active' : ''}" onclick="toggleSelectionMode()">
            ${selectionMode ? '✓ Auswahlmodus aktiv' : '☐ Themen auswählen'}
          </button>
        </div>
      ` : '';

      return `
        <div class="page-content">
          <div class="page-container fade-in">
            <div class="page-header ${phaseClass}">
              <h1>${title}</h1>
              <div class="page-header-sub">${topics.length} ${canSelect ? 'Services verfügbar' : 'Informationen'}</div>
            </div>
            ${selectButton}
            ${selectionBar}
            <div class="topic-grid">${topicButtons}</div>
            <button class="back-button" onclick="goHome()">← Zurück zum Cockpit</button>
          </div>
        </div>
      `;
    }

    function renderDetailView() {
      const item = detailContent[selectedTopic];
      const content = item.content;
      const backTitle = viewTitles[previousView] || 'Übersicht';
      
      let sectionsHtml = '';
      if (content.sections) {
        content.sections.forEach(section => {
          sectionsHtml += `<div class="detail-section">`;
          sectionsHtml += `<div class="detail-label">${section.label}</div>`;
          if (section.items) {
            sectionsHtml += `<ul class="detail-list">`;
            section.items.forEach(item => {
              sectionsHtml += `<li>${item}</li>`;
            });
            sectionsHtml += `</ul>`;
          }
          if (section.text) {
            sectionsHtml += `<div class="detail-text">${section.text}</div>`;
          }
          sectionsHtml += `</div>`;
        });
      }

      let deliverablesHtml = '';
      if (content.deliverables && content.deliverables.length > 0) {
        deliverablesHtml = `
          <div class="deliverable-box">
            <div class="deliverable-title">Deliverables</div>
            <div class="detail-text">${content.deliverables.join(' · ')}</div>
          </div>
        `;
      }

      let highlightHtml = '';
      if (content.highlight) {
        highlightHtml = `
          <div class="highlight-box">
            <p>${content.highlight}</p>
          </div>
        `;
      }

      return `
        <div class="page-content">
          <div class="page-container fade-in">
            <div class="breadcrumb">
              <span class="breadcrumb-link" onclick="goHome()">Cockpit</span>
              <span>›</span>
              <span class="breadcrumb-link" onclick="goBack()">${backTitle}</span>
              <span>›</span>
              <span>${item.title}</span>
            </div>
            <div class="detail-card">
              <h1 class="detail-header">${item.title}</h1>
              <div class="detail-section">
                <div class="detail-text">${content.intro}</div>
              </div>
              ${sectionsHtml}
              ${highlightHtml}
              ${deliverablesHtml}
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
              <button class="back-button" onclick="goBack()">← Zurück</button>
              ${!excludeFromSelection.includes(item.phase) ? `
              <button class="toggle-select-button ${selectedTopics.has(selectedTopic) ? 'active' : ''}" 
                      onclick="toggleTopicSelection('${selectedTopic}', event)" 
                      style="margin-top: 16px;">
                ${selectedTopics.has(selectedTopic) ? '✓ In Auswahl' : '+ Zur Auswahl hinzufügen'}
              </button>
              ` : ''}
              ${selectedTopics.size > 0 ? `<button class="download-button" onclick="downloadSelectedTopics()" style="margin-top: 16px;">📥 ${selectedTopics.size} Themen als Word</button>` : ''}
            </div>
          </div>
        </div>
      `;
    }

    function navigate(view) {
      previousView = currentView;
      currentView = view;
      selectedTopic = null;
      render();
      window.scrollTo(0, 0);
    }

    function selectTopic(topicId) {
      previousView = currentView;
      selectedTopic = topicId;
      render();
      window.scrollTo(0, 0);
    }

    function goHome() {
      currentView = 'home';
      selectedTopic = null;
      previousView = null;
      render();
      window.scrollTo(0, 0);
    }

    function goBack() {
      if (selectedTopic) {
        selectedTopic = null;
        render();
      } else {
        goHome();
      }
      window.scrollTo(0, 0);
    }

    render();
  </script>
</body>
</html>
